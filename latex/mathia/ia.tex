\documentclass[12pt]{article}
\usepackage{tikz}
\usepackage{apacite}
\usepackage{tabularx}
\usepackage{amsmath}
\usepackage{caption}
\usepackage{pgf}
\usepackage{graphicx}
\usepackage{amssymb}
\usepackage{multirow}
\usepackage{listings}
\usepackage{rotating}
\usepackage{colortbl}
\usepackage{tcolorbox}
\usepackage{lastpage}
\usepackage{setspace}
\usepackage[absolute]{textpos}

\doublespacing

\tcbuselibrary{breakable}
% Code listings
% Basic color definitions
\definecolor{codebg}{RGB}{245,245,245}
\definecolor{keyword}{RGB}{0,0,255}
\definecolor{comment}{RGB}{34,139,34}
\definecolor{string}{RGB}{170,55,241}

\lstset{
    basicstyle=\ttfamily\scriptsize,
    columns = fullflexible,
    backgroundcolor=\color{codebg},         
    commentstyle=\color{comment},
    keywordstyle=\color{keyword},
    stringstyle=\color{string},
    numbers=left,
    numberstyle=\tiny\color{gray},
    stepnumber=1,
    numbersep=8pt,
    showstringspaces=false,
    breaklines=true,
    frame=single,
    rulecolor=\color{gray!50},
    framesep=5pt,
    xleftmargin=15pt,
    tabsize=4,
    language=C++ % Default language
}

\begin{document}


\begin{titlepage}
    \title{\textbf{From Fibonacci Sequences to Generating Functions \\ \small Math HL Internal Assessment}}
    \author{mhz237}
    \date{}
    \centering
    \maketitle
    Page Count: \pageref{LastPage}
    %\tableofcontents
\end{titlepage}

\section{Introduction}

During the study of mathematics, there are a number of important sequences that is commonly studied. Fibonacci sequence is usually the first sequence that a learner may meet whose term is determined by not only the previous term (and probably some coefficients), but the previous two terms (recurrence relation). Except for the first two terms, every term of Fibonacci sequence is the sum of the previous two terms. To be more specific, the Fibonacci sequence is defined as follows.

\begin{tcolorbox}[colback=purple!5!white, colframe=purple!75!black, title=Definition: Fibonacci sequence]
    \label{def.fib}
    The Fibonacci sequence $\{F_n\}$ is given by  
    \begin{equation}
        \label{eq.deffib}
        F_n =
        \begin{cases}
            0, & n = 0, \\
            1, & n = 1, \\
            F_{n-1} + F_{n-2}, & n \ge 2 .
        \end{cases}
    \end{equation}
\end{tcolorbox}

Fibonacci sequence is very useful in mathematics, computer science and can be found in nature. The sequence itself is the solution to the Fibonacci Rabbit problem. Additionally, the sequence (or generalized Fibonacci sequences) give solution to many combinatorics problems. For example, the number of ways to walk $n$ steps of stairs with the condition that each time either $1$ or $2$ steps can be taken. In computer science, a consecutive pair in Fibonacci sequence can be used to test the worst possible performance of algorithms like Euclidean Greatest Common Divisor (GCD) algorithm. Fibonacci trees and heaps are also very effective data structures, whose construction and analysis requires the knowledge of Fibonacci sequence.

Despite the simple definition of the Fibonacci sequence, its closed-form expression is not as straightforward as the expression of arithmetic sequence and geometric sequence. There are records of patterns of Fibonacci sequence in ancient India (since around 200 BCE), and it was reinvented and published by Leonardo of Pisa (Fibonacci) and Liber Abaci (1202). However, it was not until the 1800s did human discover an accurate closed-form expression \cite{BritannicaFibonacci}. It is also exceptionally interesting that the sequence, despite being defined in a completely rational way, has inevitable irrational numbers in its closed-form formula. In this paper, we will study the closed-form expression of the Fibonacci sequence.

\begin{tcolorbox}[colback=blue!5!white, colframe=blue!75!black, title=Problem]
    What is $F_{n}$? Express $F_{n}$ in terms of $n$.
\end{tcolorbox}
 
\begin{tcolorbox}[colback=blue!5!white, colframe=blue!75!black, title=Generalized Problem]
    The first two terms $a_0$ and $a_1$ of an infinite sequence $\{a_n\}$ is given. The following terms are given by the formula $a_n =p a_{n-1} + q a_{n-2}$. What is $a_n$?
\end{tcolorbox}

\section{Background Knowledge and Definition}

\subsection{Maclaurin series}

Having studied sequences and calculus (especially Maclaurin series), we can notice that each infinite sequence can connect with a polynomial with infinite number of terms. To be more specific, we the following definitions and theorems in calculus are used:

\begin{tcolorbox}[colback=purple!5!white, colframe=purple!75!black, title=Definition: Taylor Series and Maclaurin Series]
    Suppose that $f$ is a function such that $f$ is $n$-times differentiable at a point $a$ ($f'(a), f''(a), \cdots f^{(n)}(a)$ exist). Then the \textbf{$n$-th degree Taylor polynomial of $f$ at $a$} \cite{calculus} is defined as:

    \begin{equation}
        P_n(x) = \sum_{k=0}^{n} \frac{f^{(k)}(a)}{k!} (x-a)^k.
    \end{equation}

    If $f$ is infinitely differentiable at $a$ and we let $n\rightarrow\infty$, we obtain the \textbf{Taylor series of $f$ at $a$}:

    \begin{equation}
        \sum_{k=0}^{\infty} \frac{f^{(k)}(a)}{k!} (x-a)^k.
    \end{equation}

    The special case where $a=0$ is called the \textbf{Maclaurin series of $f$}:

    \begin{equation}
        \label{eq.macl}
        \sum_{k=0}^{\infty} \frac{f^{(k)}(0)}{k!} x^k.
    \end{equation}
\end{tcolorbox}

Most commonly used function has a Maclaurin series. In this essay, the main kind of function that requires the analysis of Maclaurin series is in the form of $f(x) = \dfrac{1}{x-a}$.

\begin{tcolorbox}[colback=purple!5!white, colframe=purple!75!black, title=Theorem: The Maclaurin Series of 1/(x-a)]
    The main focus of this essay is not calculus; therefore, the Maclaurin series of $\dfrac{1}{x-a}$ will be given without proof.
    
    \begin{equation}
        \dfrac{1}{x-a} = \sum_{k=0}^{\infty} \dfrac{1}{a^{k+1}} x^k \quad (\text{radius of convergence:} |x| < |a|)
    \end{equation}

    
\end{tcolorbox}

\subsection{Generating functions}

Functions, on the other hand, have some ideal properties that can facilitate our understanding. To study the property of a series, it may be convenient to write them as the coefficients of an infinitely extending polynomial. In mathematics, a generating function is a clothesline on which we hang up a sequence of numbers for display \cite{wilf1990generatingfunctionology}.

\begin{tcolorbox}[colback=purple!5!white, colframe=purple!75!black, title=Definition: Generating Function]
    For a sequence $\{a_i\}$, its generating function is defined as: 
    \begin{equation}
        G(x) = \sum_{n=0}^\infty a_n x^n
    \end{equation}
\end{tcolorbox}

Here $x$ is not the variable of a polynomial, but the variable of a formal power series, or the `placeholder' for the `variable' position. The function does not have to converge on any given $x$, though sometimes it does.

Having the generating function defined this way, we can now express some sequence operations on the infinite sequence as operations on the generating function.

\begin{table}[ht!]
    \centering
    \caption{Sequence operations vs generating function operations}
    \begin{tabular}{ll}
    \hline
    \textbf{Sequence Operation} & \textbf{GF Operation} \\
    \hline
    Original sequence $(a_0, a_1, a_2, \dots)$ & $A(x) = \sum_{n=0}^{\infty} a_n x^n$ \\
    Shift right by $k$: $(0, \dots, a_0, a_1, \dots)$ & $x^k A(x)$ \\
    Shift left by 1: $(a_1, a_2, a_3, \dots)$ & $\dfrac{A(x) - a_0}{x}$ \\
    Scale by index: $(0, a_1, 2a_2, 3a_3, \dots)$ & $x A'(x)$ \\
    Scale by constant $c$: $(c a_0, c a_1, \dots)$ & $c A(x)$ \\
    Cumulative sum: $b_n = \sum_{k=0}^n a_k$ & $\dfrac{A(x)}{1 - x}$ \\
    Convolution: $c_n = \sum_{k=0}^n a_k b_{n-k}$ & $A(x)\,B(x)$ \\
    Alternating sign: $(a_0, -a_1, a_2, -a_3, \dots)$ & $A(-x)$ \\
    Difference: $b_n = a_n - a_{n-1}$ & $(1 - x) A(x)$ \\
    \hline
    \end{tabular}
\end{table}

(might need to add or modify the table, but now focus on shift)

\begin{tcolorbox}[colback=red!5!white, colframe=red!75!black, title=Proof, breakable]

\textbf{Theorem:} If $A(x)$ is the generating function of $\{a_i\}$, then $B(x) = x^kA(x)$ is the generating function of $\{b_i\}$ obtained by shifting $\{a_i\}$ to the right by $k$ positions (and inserting $k$ zeros at the beginning).

\textbf{Proof:} 

From the definition of generating function, we have 

\begin{equation}
    A(x) = \sum_{n=0}^\infty a_n x^n = a_0 + a_1 x + a_2 x^2 + \cdots
\end{equation}


Therefore we can get that 


\begin{equation}
    B(x) = x^kA(x) = \sum_{n=0}^\infty  a_n x^{n+k} = a_0 x^k + a_1 x^{k+1} + a_2 x^{k+2} + \cdots
\end{equation}

We can add shift $a$ by $k$ and $k$ zero term before the sequence to make a new sequence $b$. That is to say, $\{b_i\}$ is defined in the following way:

\begin{equation}
    b_i = \begin{cases}
        0, & i < k\\
        a_{i-k}, & i \geq k
    \end{cases}
\end{equation}

We can notice that the generating function of $\{b_i\}$ is the same as $B(x)$.

\begin{equation}
\begin{aligned}
\sum_{n=0}^\infty a_n x^{n+k}
    &= \sum_{n=0}^{k-1} 0\cdot x^n + \sum_{n=k}^\infty a_{\,n-k} x^n \\[6pt]
    &= \sum_{n=k}^\infty b_n x^n = B(x).
\end{aligned}
\end{equation}

\end{tcolorbox}

%\begin{tcolorbox}[colback=blue!5!white, colframe=blue!75!black, title=The GF of Fibonacci sequence]

The definition of Fibonacci sequence is given by Equation \eqref{eq.deffib}.

\section{Analysis}

We noticed that $F_{n-1}$ and $F_{n-2}$ are the shift of sequence that can be described by multiplying the generating function $G_0(x)$ by $x^k$. We can list $G_0(x), xG_0(x), x^2G_0(x)$ and their corresponding sequence as Table \ref{tab.shift}.

\begin{table}[ht!]
\centering
\begin{tabular}{rllllllll}
\hline
\multirow{2}{*}{Generating Function} & \multicolumn{8}{l}{The coefficient of the k-th term } \\
& $0$ & $1$ & $2$ & $3$ & $\cdots$ & $n$ & $n+1$ & $n+2$ \\ \hline
$G_0(x)$ & $F_0$ & $F_1$ & $F_2$ & $F_3$ & $\cdots$ & $F_n$ & $F_{n+1}$ & $F_{n+2}$ \\
$xG_0(x)$ & $0$ & $F_0$ & $F_1$ & $F_2$ & $\cdots$ & $F_{n-1}$ & $F_n$ & $F_{n+1}$ \\
$x^2G_0(x)$ & $0$ & $0$ & $F_0$ & $F_1$ & $\cdots$ & $F_{n-2}$ & $F_{n-1}$ & $F_n$ \\ \hline
\end{tabular}
\caption{Shifted GF and Fibonacci Sequence}
\label{tab.shift}
\end{table}

It can be noticed that for every vertical column with $n\ge 2$, it holds that the sum of the lower two terms equals the upper term, by the definition of Fibonacci sequence. The terms before $2$ can be manipulated easily. By forcing filling up the $1$ terms, we can get three equations as is shown in Equation \eqref{eq.3gfs}\footnote{Some equations in this essay is colored to emphasize that terms of the same color have the same degree of $x$.}.

\begin{subequations}
    \label{eq.3gfs}
    \begin{align}
        G_0(x)      &=     &\sum_{n=0}^{\infty} F_n x^n =
        &\textcolor{red!70!black}{F_0x^0} + 
        &\textcolor{blue!50!black}{F_1x^1} + 
        &\textcolor{green!50!black}{F_2x^2} + 
        &\textcolor{orange!60!black}{F_3x^3}\cdots \label{eq.g0def}\\
        xG_0(x)     &= 0 + &\sum_{n=0}^{\infty} F_n x^{n+1} = 
        &\textcolor{red!70!black}{0x^0} + 
        &\textcolor{blue!50!black}{F_0x^1} + 
        &\textcolor{green!50!black}{F_1x^2} + 
        &\textcolor{orange!60!black}{F_2x^3}\cdots\\
        x+x^2G_0(x) &= 1 + &\sum_{n=0}^{\infty} F_n x^{n+2} = 
        &\textcolor{red!70!black}{0x^0} + 
        &\textcolor{blue!50!black}{1x^1} + 
        &\textcolor{green!50!black}{F_0x^2} + 
        &\textcolor{orange!60!black}{F_1x^3}\cdots
    \end{align}
\end{subequations}

Therefore, by subtracting $G_0(x)$ with $xG_0(x)$ and $x^2G_0(x)$, we can get Equation \eqref{eq.3to1}.

\begin{equation}
    \label{eq.3to1}
    \begin{aligned}
         &G_0(x)-xG_0(x)-x^2G_0(x)-x\\
        =&\textcolor{red!70!black}{(F_0 - 0 - 0)}x^0 + \textcolor{blue!50!black}{(F_1 - F_0 - 1)}x^1 + \textcolor{green!50!black}{(F_2 - F_1 - F_0)}x^2 +\\
         &\textcolor{orange!60!black}{(F_3 - F_2 - F_1)} x^3 + \cdots\\
        =& 0
    \end{aligned}
\end{equation}

By the definition of Fibonacci sequence, the coefficients of $x^n$ ($n\ge2$) are all zero and these terms are eliminated. Equation \eqref{eq.3to1} can be further manipulated to get Equation \eqref{eq.fxg0x}.

\begin{equation}
    \label{eq.fxg0x}
    (1-x-x^2)G_0(x) = x
\end{equation}

Dividing $(1-x-x^2)$ on the both side, Equation \eqref{eq.g0sol} is obtained.

\begin{equation}
    \label{eq.g0sol}
    G_0(x) = \frac{x}{1-x-x^2}
\end{equation}

We can therefore conclude that Equation \eqref{eq.g0sol} is the generating function of Fibonacci sequence. However, a generating function in the factor form (instead of polynomial) does not help us understand the sequence. We can therefore use Maclaurin series to represent the GF in polynomial form.

The definition of Maclaurin series is given in Equation \eqref{eq.macl}. We need to find the Maclaurin series of $1/(1-x-x^2)$ to write the GF in polynomial form.

The denominator of the generating function, $1-x-x^2$, can be factorized by finding its roots.

\begin{equation}
    \begin{aligned}
        x &= \dfrac{-b\pm \sqrt{b^2 - 4ac}}{2a}\\
          &= \dfrac{1\pm\sqrt{(-1)^2+4}}{2\times(-1)}\\
          &= \dfrac{-1\pm\sqrt{5}}{2} \\
          & (x_1 = \dfrac{-1+\sqrt{5}}{2}, x_2 = \dfrac{-1-\sqrt{5}}{2})
    \end{aligned}
\end{equation}

\begin{equation}
    1-x-x^2 = -(x-x_1)(x-x_2)
\end{equation}

Assuming that $\lambda_1$ and $\lambda_2$ are constants, and 

\begin{equation}
    \begin{aligned}
        \dfrac{x}{1-x-x^2} &= \dfrac{\lambda_1}{x-x_1} + \dfrac{\lambda_2}{x-x_2}\\
                           &= -\dfrac{\lambda_1(x-x_2)+\lambda_2(x-x_1)}{1-x-x^2}\\
                           &= -\dfrac{(\lambda_1+\lambda_2)x - \lambda_1x_2 - \lambda_2x_1}{1-x-x^2}\\
    \end{aligned}
\end{equation}

Therefore 

\begin{equation}
    \begin{cases}
        \lambda_1 + \lambda_2 = -1\\
        \lambda_1x_2 + \lambda_2x_1 = 0
    \end{cases}
\end{equation}

We can therefore get

\begin{equation}
    \begin{aligned}
        \lambda_1 &= \dfrac{x_1}{x_1-x_2} = \dfrac{\sqrt{5}-5}{10}\\
        \lambda_2 &= \dfrac{-x_2}{x_1-x_2}= \dfrac{-\sqrt{5}-5}{10}\\
    \end{aligned}
\end{equation}

Therefore $G_0(x)$ can now be re-written as $\dfrac{\lambda_1}{x-x_1} + \dfrac{\lambda_2}{x-x_2}$.

By the definition of Maclaurin series, we can get that 

\begin{equation}
    \begin{aligned}
        G_0(x) &= \dfrac{\lambda_1}{x-x_1} + \dfrac{\lambda_2}{x-x_2} \\
        &=-\sum_{n=0}^{\infty}\dfrac{\lambda_1}{x_1^{n+1}}x^n -\sum_{n=0}^{\infty}\dfrac{\lambda_2}{x_2^{n+1}}x^n\\
        &=-\sum_{n=0}^{\infty}\dfrac{\lambda_1 x_2^{n+1} + \lambda_2 x_1^{n+1}}{(x_1x_2)^{n+1}}x^n\\
        &=\sum_{n=0}^{\infty}\dfrac{\frac{1}{\sqrt{5}} x_2^n - \frac{1}{\sqrt{5}} x_1^n}{(-1)^{n}}x^n\\
        &=\sum_{n=0}^{\infty}\dfrac{x_2^n - x_1^n}{\sqrt{5}(-1)^{n}}x^n\\
        &=\sum_{n=0}^{\infty}\dfrac{(\frac{-1-\sqrt{5}}{2})^n - (\frac{-1+\sqrt{5}}{2})^n}{\sqrt{5}(-1)^{n}}x^n\\
        &=\sum_{n=0}^{\infty}\dfrac{(\frac{1+\sqrt{5}}{2})^n - (\frac{1-\sqrt{5}}{2})^n}{\sqrt{5}}x^n\\
    \end{aligned}
\end{equation}

By the definition of the GF, the coefficient of the $n$-th term is the $n$-th term of Fibonacci sequence.

\begin{equation}
    F_n = \dfrac{(\frac{1+\sqrt{5}}{2})^n - (\frac{1-\sqrt{5}}{2})^n}{\sqrt{5}}
\end{equation}

\section{Verification}

Despite the complicated process of finding the closed term expression, the conclusion can be verified both algebraically and graphically simply.

\subsection{Algebraic Verification}

It can be noticed that the Golden Ratio is found in the closed form. Let $\varphi = \dfrac{1+\sqrt{5}}{2}$ and $\psi = \dfrac{1-\sqrt{5}}{2}$. We have 

\begin{equation}
    \begin{aligned}
        \varphi^2 &= 1 + \varphi\\
        \psi^2 &= 1 + \psi\\
    \end{aligned}
\end{equation}

Let the statement $P_{k}$ be ``$F_{k} = \dfrac{\varphi^k - \psi^k}{\sqrt{5}}$''.

$P_0$ is true because $F_0 = \dfrac{\varphi^0 - \psi^0}{\sqrt{5}} = 0$.

$P_1$ is true because $F_1 = \dfrac{\varphi^1 - \psi^1}{\sqrt{5}} = 1$.

For some positive integer $k>1$, assume $\forall i \in \mathbb{N}\cap[0, k-1], P_{i}$ is true.

Then

\begin{equation}
    \begin{cases}
        F_{k-1} = \dfrac{\varphi^{k-1} - \psi^{k-1}}{\sqrt{5}}\\
        F_{k-2} = \dfrac{\varphi^{k-2} - \psi^{k-2}}{\sqrt{5}}\\
    \end{cases}
\end{equation}

Then

\begin{equation}
    \begin{aligned}
        F_{k} &= F_{k-1} + F_{k-2}\\
              &= \dfrac{\varphi^{k-1} - \psi^{k-1}}{\sqrt{5}} + \dfrac{\varphi^{k-2} - \psi^{k-2}}{\sqrt{5}}\\
              &= \dfrac{(\varphi\times\varphi^{k-2} - \psi\times\psi^{k-2})}{\sqrt{5}} + \dfrac{\varphi^{k-2} - \psi^{k-2}}{\sqrt{5}}\\
              &= \dfrac{(\varphi^{k-2}(1+\varphi) - \psi^{k-2}(1+\psi))}{\sqrt{5}}\\
              &= \dfrac{(\varphi^{k-2}\varphi^2 - \psi^{k-2}\psi^2)}{\sqrt{5}}\\
              &= \dfrac{(\varphi^{k} - \psi^{k})}{\sqrt{5}}\\
    \end{aligned}
\end{equation}

Which means $P_{k}$ is true.

\begin{equation}
    \begin{cases}
        &\forall n \in \{0,1\}, P_n\, \text{is true}\\
        &\forall n \ge 2, (P_{0}, P_{1} \cdots P_{n-1}\, \text{is true})\Rightarrow P_{n}\\
    \end{cases}
\end{equation}

According to the strong mathematical induction, $P_{n}$ is true for all $n \in \mathbb{N}$.

\subsection{Numerical Verification}

% More description needed

We can plot the \textit{derived generating function} (shown in Equation \eqref{eq.fxg0x}) with the first few terms of \textit{generating function by definition} (shown in Equation \eqref{eq.g0def}). It can be noticed that, as the number of terms increase, the blue lines (the first $n$ terms) get closer to the red line (the generating function). This indicates that the first few terms of the generating function by definition is a good approximation of the derived generating function, as is shown in Figure \ref{fig.verif}. This suggests that the derived generating function is indeed the correct one.

\begin{figure}[ht!]
    \centering
    \resizebox{\textwidth}{!}{\input{facvspoly.pgf}}
    \caption{Verification of the generating function.}
    \label{fig.verif}
\end{figure}

\section{Generalized Problem}

\begin{tcolorbox}[colback=blue!5!white, colframe=blue!75!black, title=Generalized Problem]
    The first two terms $b_0$ and $b_1$ of an infinite sequence $\{b_n\}$ is given. The following terms are given by the formula 
    
    \begin{equation}\label{eq.defb}
        b_n = p b_{n-1} + q b_{n-2} \quad (n \ge 2)
    \end{equation}
    
    What is $b_n$?

    (It can be noticed that the special case where $p = q = 1$ is the Fibonacci sequence.)
\end{tcolorbox}

Similarly, we define the generating function of the sequence as follows.

\begin{equation}
    \label{eq.gb}
    G_{b}(x) = \sum_{n=0}^\infty b_n x^n
\end{equation}

The equation involves three consecutive terms. We can therefore simulate the moving operation by multiplying the equation by $x$ and $x^2$ respectively.

\begin{subequations}\label{eq.3gbx}
    \begin{align}
        G_{b}(x) &= \sum_{n=0}^\infty b_n x^n =
        &\textcolor{red!70!black}{b_0} + 
        &\textcolor{blue!50!black}{b_1 x} + 
        &\textcolor{green!50!black}{b_2 x^2} + 
        &\textcolor{orange!60!black}{b_3 x^3} 
        &\cdots \label{eq.3x0gbx}\\
        xG_{b}(x) &= \sum_{n=0}^\infty b_n x^{n+1} = 
        &\textcolor{red!70!black}{0} + 
        &\textcolor{blue!50!black}{b_0 x} + 
        &\textcolor{green!50!black}{b_1 x^2} + 
        &\textcolor{orange!60!black}{b_2 x^3} + 
        &\cdots \label{eq.3x1gbx}\\
        x^2G_{b}(x) &= \sum_{n=0}^\infty b_n x^{n+2}
    \end{align}
\end{subequations}


In the general case, there is a coefficient in front of the terms of the definition. To utilize the identity, we have to construct corresponding terms in Equation \eqref{eq.3gbx}. To achieve that, we multiple Equation \eqref{eq.3x1gbx} by the coefficient $p$ and Equation \eqref{eq.3x2gbx} by the coefficient $q$. Therefore we have Equation \eqref{eq.x1gbx} and Equation \eqref{eq.x2gbx}. 

\begin{subequations}\label{eq.4gbterms}
    \begin{align}
        G_{b}(x) &= \sum_{n=0}^\infty b_n x^n 
        = &\textcolor{red!70!black}{b_0} 
        &+ \textcolor{blue!50!black}{b_1 x} 
        &+ \textcolor{green!50!black}{b_2 x^2} 
        &+ \textcolor{orange!60!black}{b_3 x^3} + \cdots \label{eq.x0gbx}\\
        p x G_{b}(x) &= \sum_{n=0}^\infty p b_n x^{n+1} 
        = &0 
        &+ \textcolor{blue!50!black}{p b_0 x} 
        &+ \textcolor{green!50!black}{p b_1 x^2} 
        &+ \textcolor{orange!60!black}{p b_2 x^3} + \cdots \label{eq.x1gbx}\\
        q x^2 G_{b}(x) &= \sum_{n=0}^\infty q b_n x^{n+2} 
        = &0 &+ 0
        &+ \textcolor{green!50!black}{q b_0 x^2} 
        &+ \textcolor{orange!60!black}{q b_1 x^3} + \cdots \label{eq.x2gbx}
    \end{align}
\end{subequations}

The definition Equation \eqref{eq.defb} shows that 

\begin{equation}\label{eq.defb2}
    \forall n\in\mathbb{N}, n\ge2, b_n - p b_{n-1} - q b_{n-2}= 0
\end{equation}

Therefore subtracting the sum of Equation \eqref{eq.x1gbx} and Equation \eqref{eq.x2gbx} from Equation \eqref{eq.x0gbx}, we have Equation \eqref{eq.fxgbx}, whose $x^n(n\ge2)$ terms are all zero.

\begin{equation}\label{eq.fxgbx}
    \begin{aligned}
    &(1 - p x - q x^2) G_b(x)\\
    =& \textcolor{red!70!black}{b_0} \\
    &+ \textcolor{blue!50!black}{(b_1 - p b_0)} x \\
    &+ \textcolor{green!50!black}{(b_2 - p b_1 - q b_0)} x^2 \\
    &+ \textcolor{orange!60!black}{(b_3 - p b_2 - q b_1)} x^3 + \cdots
    \end{aligned}
\end{equation}

The green and orange colored bracket and all the following terms are zero.

With algebraic manipulation, we can move all things to the right and find $G_b(x)$, as is shown in 

\begin{equation}\label{eq.gbxans}
    G_b(x)= \dfrac{\textcolor{red!70!black}{b_0}+ \textcolor{blue!50!black}{(b_1 - p b_0)} x}{1 - p x - q x^2}
\end{equation}

All the remaining is following the process of finding the Maclaurin series.

Using the root formula, we can factorize the denominator $1 - p x - q x^2$ let the roots be $\alpha$ and $\beta$. 

\begin{equation}\label{eq.factorizedenom}
    \alpha = \dfrac{p+ \sqrt{p^2 + 4q}}{-2q}, \beta = \dfrac{p- \sqrt{p^2 + 4q}}{-2q}
\end{equation}

It can also be noticed that $\alpha \times \beta = -\dfrac{1}{q}$

Assuming $\mu, \rho$ are constants and $\dfrac{\mu}{x-\alpha} + \dfrac{\rho}{x-\beta} = G_b(x)$, we can solve for $\mu$ and $\rho$.

Due to the page limit, $\mu$ and $\rho$ are directly given:

\begin{equation}\label{eq.mu1mu2}
    \begin{aligned}
        \mu &= \dfrac{\alpha b_0+b_1-p b_0}{\alpha+\beta}\\
        \rho &= \dfrac{\alpha b_0-b_1+p b_0}{\alpha+\beta}
    \end{aligned}
\end{equation}

Then

\begin{equation}\label{eq.explicit2}
    \begin{aligned} 
        -G_b(x) &= \dfrac{\mu}{x-\alpha} + \dfrac{\rho}{x-\beta}\\
                &= \sum_{n=0}^{\infty} \dfrac{\mu}{\alpha^{n+1}}x^n + \sum_{n=0}^{\infty} \dfrac{\rho}{\beta^{n+1}}x^n\\
                &= \sum_{n=0}^{\infty} (\dfrac{\mu\beta^{n+1}+\rho\alpha^{n+1}}{(\alpha\beta)^{n+1}})x^n
    \end{aligned}
\end{equation}

Therefore

\section{Reflection}

This essay discussed the generating functions and utilized it to derive a closed form expression of Fibonacci sequence. It also provided two verifications on the mathematical process. Additionally, this essay revealed the connection between two parts of modern mathematics: combinatorics and analysis (calculus), revealing the interconnection in mathematics.

The use of generating function is not limited to finding the closed form of a sequence. It can also 

\begin{itemize}
    \item Find averages and other statistical properties of a given sequence.
    \item Find asymptotic formulas for a given sequence.
    \item Prove some advanced identities \cite{wilf1990generatingfunctionology}.
\end{itemize}

This essay include one kind of generalization of the Fibonacci sequence, and proved that generating function is still useful for such generalization. However, there are other generalizations of the Fibonacci sequence that are not included in this essay, which may include

\begin{itemize}
    \item ``Tribonacci'' or ``n-bonacci'' sequence, where the terms are the sum of the previous three or $n$ terms. This can be solved by listing of all the $x^k G(x)$ terms. However, the explicit expression is very long and hard to calculate \cite{Tribonacci}.
    \item Multiplication Fibonacci sequence, where the terms are the product of the previous two terms. This can be solved by realizing the logarithm of the terms form a normal Fibonacci sequence and find the closed form expression for the logarithm of each term.
    \item Abelian group Fibonacci sequence, where the elements are communicative but does not have all the properties of integers. For example, the Fibonacci sequence of vectors or integers modulo a prime number. Depending on the properties of the group, the generating function may no longer be a viable method, and algorithms like matrix quick pow or BSGS algorithm may be helpful.
\end{itemize}

This essay did not include further discussion on the application of generating function due to the page limit.

% and exponential asymptote should be added as well 

\bibliographystyle{apacite}
\bibliography{cit.bib}

\section*{Appendix}

\lstinputlisting[
    caption={Numerical Verification},
    label=lst.verif
]{cmp.py}

%\end{tcolorbox}

\end{document}



